qmd:
  bin: /home/jacyl4/.bun/bin/qmd
  index_db: ~/.cache/qmd/index.sqlite
  mcp_port: 8181

server:
  grpc_listen: 127.0.0.1:19091
  security_model: loopback_trust

collections:
  - name: claw-memory
    path: /home/jacyl4/1base/@obsidian/digital/openclaw/workspace/memory
    mask: "**/*.md"
    context: "OpenClaw AI助手的工作记忆：GTD任务、每日日志、个人财务、购物清单"
    tier: 1
    embed: true

  - name: digital
    path: /home/jacyl4/1base/@obsidian/digital
    mask: "**/*.md"
    exclude:
      - "openclaw/workspace/**"
    context: "个人数字知识库：技术笔记、学习资料、开源项目文档、网络架构、Kubernetes、流量整形路由系统"
    tier: 2
    embed: true

  - name: yozo
    path: /home/jacyl4/1base/@obsidian/yozo
    mask: "**/*.md"
    context: "工作知识库：公司项目、Kubernetes集群架构重建、企业网络规划"
    tier: 2
    embed: true

  - name: personal
    path: /home/jacyl4/1base/@obsidian/personal
    mask: "**/*.md"
    context: "个人隐私知识库：私人笔记、社交关系、生活规划"
    tier: 99
    embed: true
    require_explicit: true
    safety_prompt: true

search:
  default_mode: auto
  coarse_k: 20
  top_k: 8
  min_score: 0.3
  max_chars: 4500
  files_all_max_hits: 200
  fallback_enabled: true

cache:
  enabled: true
  ttl: 30m
  max_entries: 500
  cleanup_interval: 1h
  version_aware: true

scheduler:
  index_refresh: 30m
  embed_refresh: 24h
  embed_full_refresh: 168h
  cache_cleanup: 1h

guardian:
  check_interval: 60s
  timeout: 5s
  restart_max_retries: 3

logging:
  level: info
  file: /var/log/qmdsr/qmdsr.log
  max_size: 10MB
  max_backups: 3

runtime:
  low_resource_mode: true
  allow_cpu_deep_query: false
  allow_cpu_vsearch: true
  cpu_overload_protect: true
  cpu_overload_threshold: 90
  cpu_overload_sustain: 10s
  cpu_recover_threshold: 75
  cpu_recover_sustain: 12s
  cpu_critical_threshold: 95
  cpu_critical_sustain: 5s
  overload_max_concurrent_search: 2
  cpu_sample_interval: 1s
  smart_routing: true
  # The cpu_deep_* smart-routing limits below only take effect when allow_cpu_deep_query: true.
  cpu_deep_min_words: 12
  cpu_deep_min_chars: 30
  cpu_deep_max_words: 28
  cpu_deep_max_chars: 160
  cpu_deep_max_abstract_cues: 2
  query_max_concurrency: 1
  query_timeout: 30s
  deep_fail_timeout: 12s
  deep_negative_ttl: 60m
  # Scope cooldown is only used when allow_cpu_deep_query: true.
  deep_negative_scope_cooldown: 10m
